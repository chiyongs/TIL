# 데이터베이스의 기본

- 데이터베이스 : 일정한 규칙 혹은 규약을 통해 구조화되어 저장되는 데이터의 모음
- 실시간 접근과 공유 가능
- 엔티티 : 사람, 장소, 물건, 사건 개념 등 여러 개의 속성을 지닌 명사를 의미
- 릴레이션 : 데이터베이스에서 정보를 구분하여 저장하는 기본 단위
  - 관계형 데이터베이스 : 테이블
  - NoSQL 데이터베이스 : 컬렉션
- 속성 : 릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보
- 도메인 : 릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합

## 정규화

- 정규화 과정은 릴레이션 간의 잘못된 종속 관계로 인해 데이터베이스 이상 현상을 해결하거나, 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정
- 이상현상은 테이블을 설계할 때 잘못 설계하여 데이터의 삽입, 삭제, 수정 시 생기는 논리적 오류를 말합니다.
- 삽입 이상 : 자료를 삽입할 때 특정 속성에 해당하는 값이 없어 NULL을 입력해야 하는 현상입니다.
- 갱신 이상 : 중복된 데이터 중 일부만 수정되어 데이터 모순이 일어나는 현상입니다.
- 삭제 이상 : 어떤 정보를 삭제하면, 의도하지 않은 다른 정보까지 삭제되어버리는 현상입니다.
- 이러한 이상 현상을 예방하고 효과적인 연산을 하기위해 데이터 정규화를 합니다.
- 정규화의 원칙
  - 자료의 중복성은 감소해야 하고 독립적인 관계는 별개이 릴레이션으로 표현해야 하며, 각각의 릴레이션은 독립적인 표현이 가능해야 함
- 제1 정규형 : 테이블의 컬럼이 원자 값을 가지도록 분해합니다.
- 제2 정규형 : 제1 정규형을 만족하고 기본키가 아닌 속성이 기본키에 완전 함수 종속이도록 분해합니다.
  - 완전 함수 종속 : 기본키의 부분집합이 다른 값을 결정하지 않는 것을 의미
- 제3 정규형 : 제2 정규형을 만족하고 이행적 함수 종속을 없애도록 분해합니다.
  - 이행적 함수 종속 : A→B, B→C가 성립할 때 A→C가 성립되는 것을 의미
- BCNF 정규형 : 제3 정규형을 만족하고, 함수 종속성 X→Y가 성립할 때 모든 결정자 X가 후보키가 되도록 분해합니다.

- 정규화 장점
  - 데이터베이스 구조 확장 시 정규화된 데이터베이스는 변경하지 않아도 되거나 일부만 변경하면 됩니다.
  - 이상현상이 발생하는 문제점을 해결할 수 있습니다.
- 정규화 단점
  - 릴레이션의 분해로 인해 JOIN연산이 많아집니다. 이로인해 질의에 대한 응답시간이 느려질 수 있습니다.

# 트랜잭션과 무결성

## 트랜잭션

- 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업의 단위
- 여러 개의 쿼리들을 하나로 묶는 단위

### 원자성 Atomicity

- 트랜잭션과 관련된 일이 모두 수행되었거나 되지 않았거나를 보장하는 특징

> 커밋과 롤백

- 커밋 : 여러 쿼리가 성공적으로 처리되었다고 확정하는 명령어
  - 트랜잭션 단위로 수행되며 변경된 내용이 모두 영구적으로 저장되는 것을 말함
- 롤백 : 트랜잭션으로 처리한 하나의 묶음 과정을 일어나기 전으로 돌리는 일

이런 커밋과 롤백으로 데이터의 무결성이 보장됨

### 일관성 Consistency

- 허용된 방식으로만 데이터를 변경해야 하는 것을 의미
- 데이터베이스에 기록된 모든 데이터는 여러 가지 조건, 규칙에 따라 유효함을 가져야 함

### 격리성 Isolation

- 트랜잭션 수행 시 서로 끼어들지 못하는 것
- 복수의 병렬 트랜잭션은 서로 격리되어 마치 순차적으로 실행되는 것처럼 작동되어야 함 & 데이터베이스는 여러 사용자가 같은 데이터에 접근할 수 있어야 함

> 트랜잭션 격리 수준

- Serializable : 트랜잭션을 순차적으로 진행시키는 것
  - 여러 트랜잭션이 동시에 같은 행에 접근할 수 없음
  - 매우 엄격한 수준, 교착 상태가 일어날 확률이 높으며 가장 성능이 떨어짐
- Repeatable Read : 하나의 트랜잭션이 수정한 행을 다른 트랜잭션이 수정할 수 없도록 막아주지만 새로운 행을 추가하는 것을 막지 않음 → 이후에 추가된 행이 발견될 수 있음
  - Phantom read : 한 트랜잭션 내에서 동일한 쿼리를 보냈을 때 해당 조회 결과가 다른 경우
- Read commited : 커밋이 완료된 데이터에 대해서만 조회를 허용, 커밋되지 않는 정보는 읽을 수 없음
  - 가장 많이 사용되는 격리 수준
  - Non-repeatable read : 한 트랜잭션 내의 같은 행에 두 번 이상 조회가 발생했는데 그 값이 다른 경우
- Read uncommited : 하나의 트랜잭션이 커밋되기 이전에 다른 트랜잭션에 노출되는 문제가 있지만 가장 빠르고 가장 낮은 수준의 격리 수준

### 지속성 Durability

- 성공적으로 수행된 트랜잭션은 영원히 반영되어야 하는 것을 의미
- 데이터베이스에 시스템 장애가 발생해도 원래 상태로 복구하는 회복기능이 있어야 함을 뜻함

## 무결성

- 데이터의 정확성, 일관성, 유효성을 유지하는 것
- 무결성이 유지되어야 데이터에 대한 신뢰가 생김
