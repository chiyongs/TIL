# JVM 이해하기

## 자바, JVM, JDK 그리고 JRE

### JVM

Java Virtual Machine, 자바 가상 머신으로 자바 바이트 코드(.class)를 인터프리터와 JIT 컴파일러를 사용하여 OS에 특화된 코드로 변환하여 실행한다.

바이트 코드를 실행하는 표준이자 구현체이다.
→ JVM 자체는 표준이나 특정 벤더들이 자신들의 입맛에 맞게 구현한다. (JVM 벤더 : 오라클, 아마존, Azul)

특정 플랫폼에 종속적이다. (네이티브 코드(OS)에 맞춰서 실행해야 하기 때문)

### JRE

Java Runtime Environment, 자바 애플리케이션을 실행할 수 있도록 구성된 배포판이다.
JVM과 핵심 라이브러리, 프로퍼티 세팅, 리소스 파일들을 가지고 있다.
개발 툴은 포홤되어 있지 않다.

### JDK

Java Development Kit, JRE + 개발에 필요한 툴이 들어있다.
소스 코드를 작성할 때 사용하는 자바 언어는 플랫폼에 독립적이다.
오라클은 자바 11부터 JDK만 제공하고, JRE를 따로 제공하지 않는다.

### Java

프로그래밍 언어이다.
JDK에 들어있는 자바 컴파일러(javac)를 사용하여 바이트코드(.class 파일)로 컴파일할 수 있다.

## JVM 구조

JVM은 크게 보면 4가지로 분류할 수 있다.

### 클래스 로더 시스템

자바 바이트코드를 읽어 메모리에 저장하는 것이 주로 하는 일이다.

- 로딩 : 클래스를 읽어오는 과정
- 링크 : 레퍼런스를 연결하는 과정
- 초기화 : static 값들을 초기화하며 변수에 할당

### 메모리

스택, PC, 네이티브 메소드 스택은 각각의 쓰레드에 국한되어있다.
힙, 메소드는 여러 쓰레드에서 공유하여 사용 가능한 자원이다.

- 스택
  - 쓰레드마다 런타임 스택을 만들고, 그 안에서 메소드 호출을 스택 프레임 블럭으로 쌓는다.
  - 쓰레드가 종료하면 런타임 스택도 사라진다.
- PC
  - Program Counter 레지스터, 쓰레드마다 쓰레드 내 현재 실행할 instruction의 위치를 가리키는 포인터가 생성된다.
- 네이티브 메소드 스택
  - 네이티브 메소드 : 메소드에 native라는 키워드가 붙어있고, 구현을 Java가 아닌 C나 C++로 되어있는 메소드이다.
  - JNI을 통해 메소드가 호출되면 네이티브 메소드 스택에 쌓인다.
  - ex) Thread.currentThread()
- 힙
  - 객체(인스턴스)를 저장한다. 다른 영역에 공유되는 자원이다.
- 메소드
  - 클래스 수준의 정보(클래스 이름, 부모 클래스 이름, 메소드, 변수)를 저장된다.
  - 메소드 영역에 저장된 정보들은 다른 영역에서도 참조할 수 있는 공유되는 자원이다.
