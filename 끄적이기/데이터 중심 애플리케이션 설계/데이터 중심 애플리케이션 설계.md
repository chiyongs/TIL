# 06. 파티셔닝

대체로 각 데이터 단위를 1개의 파티션으로 만든다.
그 자체로 1개의 작은 데이터베이스.
파티셔닝을 하는 주 된 원인은 확장성

단일 파티션에 실행되는 질의를 각 노드에서 자신의 파티션으로 해당 질의를 독립적으로 실행하게 되면
-> 노드를 추가할 때마다 질의 처리량이 증가

## 파티셔닝과 복제

1개의 노드에 여러 파티션이 존재 가능
각 노드에서 각 파티션은 리더일 수도 있고 팔로워일 수도 있다.
: 리더-팔로워 복제 모델

## 키-값 데이터 파티셔닝

파티셔닝 : 데이터와 질의 부하를 각 노드에 균등하게 분산시키는 것
동일한 분량을 담당한다는 가정 하에 1개의 노드가 10개의 노드가 되면
-> 10배의 데이터를 저장할 수 있고, 10배의 읽기, 쓰기 요청에 대한 처리가 가능

쏠림 : 파티셔닝이 고르게 이루어지지 않아 다른 파티션보다 데이터가 많거나 질의 처리를 많이 하는 파티션이 존재하는 경우
핫스팟 : 불균형하게 부하가 높은 파티션

핫스팟을 해결하는 가장 쉬운 방법
: 데이터 저장 시 무작위로 분산하여 저장
-> 데이터를 모두 고르게 분산할 수 있지만, 데이터 탐색 시 모든 노드에서 병렬적으로 탐색을 수행해야 함

키-값 데이터 모델
: 항상 기본 키를 통해 레코드에 접근
-> 항상 빨리 찾을 수 있다.
ex) 백과사전

## 키 범위 기준 파티셔닝

파티셔닝 방법 : 백과사전
각 파티션에 연속된 범위의 키를 할당
-> 각 범위의 경계를 알면 데이터를 어디에 저장했는지 파악이 쉬움
(어느 키가 어느 파티션에 속하는지)

각 파티션이 어느 노드에 할당되어 있는지 알면 적절한 노드로 요청도 가능

키 범위가 파티션별로 동일할 필요는 없다.
데이터에 맞게 범위는 조정되어야 한다.
그렇지 않으면 데이터 쏠림 현상이 발생할 수 있다.

각 파티션 내에서 키는 정렬된 순서로 유지된다.
그로 인해 빠르게 탐색이 가능하다.
하지만, 키 범위 기준 파티셔닝은 특정 접근 패턴에 대해 핫스팟을 유발할 수 있다.
예를 들어, 타임스팸프가 키라면 해당 날짜에 대한 파티션만 부하를 받고 나머지는 유휴 상태로 유지
