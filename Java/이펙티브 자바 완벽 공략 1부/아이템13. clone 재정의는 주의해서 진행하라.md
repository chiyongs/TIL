# 아이템13. clone 재정의는 주의해서 진행하라

## Clone 규약

clone : 오브젝트를 그대로 복사하는 기능

Clone을 만드려면 Cloenable 인터페이스를 꼭 구현해야 하고 clone 메소드를 재정의해야 한다.

Cloneable 인터페이스는 마커 인터페이스처럼 속이 비어있지만, clone을 사용하기 위해서는 꼭 구현해야 함.

1. clone은 반드시 원본과 다른 인스턴스여야 한다.
   1. x.clone ≠ x → 반드시 참이여야 한다. (논리적 동치성은 같을 수 있겠지만, 레퍼런스 자체가 다른 오브젝트를 참조해야 함)
2. clone해서 만들어진 오브젝트의 클래스와 원본의 클래스가 같아야 한다.
   1. x.clone().getClass() == x.getClass() → 반드시 참
3. x.clone().eqauls(x) 가 true가 아닐 수도 있다.

clone 메소드를 사용해서 만들어지는 인스턴스는 생성자를 사용해서 만들어지지 않는다.

## 가변 객체의 clone을 정의하는 방법

1. 접근 제한자는 public, 반환타입은 자기 자신 클래스로 변경한다.
2. super.clone을 호출하고 필요한 필드를 적절히 수정한다.

주의할 점

- 배열을 가지고 있는 경우 배열도 clone 해줘야 한다.
  - 이유 : 원본과 복사본이 동일한 배열을 참조하기 때문에 한 쪽의 수정이 발생하면 다른 쪽에도 영향을 끼친다.
  - 하지만, 배열을 clone해도 원본 배열과 복사본 배열의 내부에 존재하는 원소는 같은 인스턴스를 참조하고 있다. 그래서 여기서 또 문제가 발생한다. (shallow copy이기 때문)
  - 이런 경우를 해결하기 위해서는 deep copy를 해야 한다.
    deep copy를 할 때는 새로운 배열을 만들고 해당 배열에 deep copy 해줘야한다.
