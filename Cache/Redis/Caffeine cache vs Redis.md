# Caffeine Cache vs Redis

카페인 캐시와 레디스를 비교하기 전에 먼저 로컬 캐시와 글로벌 캐시에 대해서 정리해야 한다.

### 로컬 캐시와 글로벌 캐시

로컬 캐시와 글로벌 캐시는 모두 컴퓨터 시스템에서 데이터에 대한 액세스를 빠르게 하기 위해 사용되는 저장소이다.

로컬 캐시는 하나의 서버에서 사용하는 캐시이며, 해당 서버에서 실행되는 애플리케이션에 적용된다.
다른 서버에서는 접근하거나 사용할 수 없다.

글로벌 캐시는 여러 서버에서 공유할 수 있는 캐시이다.
여러 서버에서 공유되는 데이터나 리소스에 대한 액세스를 더욱 효율적으로 만들기 위해 사용한다.
예시로, 분산 시스템에서는 여러 노드에서 공유하는 데이터를 빠르게 액세스하기 위해 글로벌 캐시를 사용한다.

## Caffeine Cache

Caffeine Cache는 로컬 캐시의 한 종류이다.

- 자바 언어로 작성된 오픈 소스 로컬 캐시 라이브러리
- ConcurrentHashMap과 같은 자바 컬렉션 인터페이스를 구현하여, 매우 빠르고 효율적인 메모리 기반의 캐시를 제공

### Caffeine Cache 특징

1. 캐시 크기 제한 : 캐시 크기를 제한하여 너무 많은 메모리를 사용하지 않도록 한다.
2. TTL 및 TTI 설정 : Time-to-Live 및 Time-to-Idle을 설정하여 캐시에서 오래된 데이터를 자동으로 삭제한다.
3. 높은 성능 : 인터페이스가 ConcurrentHashMap과 유사하여 매우 빠르고 효율적인 캐시를 제공한다.
4. 비동기 로딩 : 값을 비동기적으로 로드하여 캐시를 사용할 때 성능을 향상시킨다.

Caffeine Cache는 자바 8 이상을 지원하며, 메모리 기반의 로컬 캐시로 분산 시스템에서는 사용하기 어렵다.

하지만, 단일 서버 환경에서는 매우 효율적인 로컬 캐시 라이브러리로 자주 사용된다.

## Caffeine Cache vs Redis

Caffeine Cache : 로컬 캐시 vs Redis : 글로벌 캐시

- 구조
  - Caffeine Cache는 단일 서버에서 메모리 기반 캐시로 작동한다.
    하지만, Redis는 여러 서버에서 글로벌 캐시(분산 캐시)로 작동한다.
    Redis는 클러스터 모드로 구성될 수 있으며, 여러 서버에서 데이터를 분산하고 복제하여 안정성과 가용성을 높인다.
- 데이터 저장소
  - Caffeine Cache는 로컬 서버의 메모리에 데이터를 저장한다.
    Redis는 디스크 또는 메모리에 데이터를 저장할 수 있다.
    따라서, Redis는 대규모의 데이터를 저장할 수 있다.
- 데이터 형식
  - Caffeine Cache는 객체 형식의 데이터를 지원한다.
    Redis는 문자열, 리스트, 해시, 집합 및 정렬 집합 등 다양한 데이터 형식을 지원한다.
- 스케일링
  - Caffeine Cache는 로컬 캐시이므로 단일 서버에서만 작동한다.
    Redis는 여러 서버에서 작동하며, 쉽게 확장할 수 있다.

Caffeine Cache와 Redis는 각각 다른 목적과 사용 방법을 가지고 있다.
Caffeine Cache는 단일 서버 환경에서 매우 빠르고 간단한 로컬 캐시 솔루션이고, Redis는 대규모 분산 시스템에서 사용되며, 데이터 저장, 분산, 복제 및 검색 등 다양한 작업을 처리할 수 있다.

### 서버가 여러 대라면 어느 것이 더 좋을까?

서버가 여러 대인 경우에는 Redis와 같은 분산 캐시 솔루션이 Caffeine Cache보다 더 적합할 수 있다.

이유

- 확장성
  - 분산 캐시 솔루션인 Redis는 여러 서버에서 데이터를 저장하고 분산시킬 수 있다.
    이에 따라 Redis를 사용하면 필요에 따라 서버를 추가하거나 제거하여 캐시 용량을 늘리거나 축소할 수 있다.
    이는 서버 부하를 분산시키고 캐시 효율을 높이는 데 도움이 된다.
- 안정성
  - 분산 캐시 솔루션인 Redis는 여러 서버에서 데이터를 복제하고 분산시키므로, 한 서버에 장애가 발생해도 다른 서버에서 데이터를 읽을 수 있다.
    따라서, 캐시 서버의 안정성이 향상된다.
- 다양한 데이터 구조 지원
  - Redis는 다양한 데이터 구조를 지원하므로, Caffeine Cache와 같은 단일 서버 캐시 솔루션보다 더 다양한 용도로 사용될 수 있다.

하지만, 단일 서버에서 작동하고 간단한 캐시 용도로만 사용한다면 Caffeine Cache와 같은 로컬 캐시 솔루션이 더 유용할 수 있다.

캐시 솔루션은 사용 목적과 용도, 요구 사항 및 예산 등에 따라 적절하게 선택해야 한다.

### 그렇다면, 서버가 여러 대인 경우 Redis의 속도는 괜찮을까?

Redis는 내부 아키텍처가 메모리에 데이터를 저장하고, 네트워크를 통해 고속으로 데이터를 전송하며, 멀티스레딩을 사용하여 동시 요청을 처리하는 방식 덕분에 대개 높은 성능을 보인다.
따라서, 대규모 데이터와 빠른 응답 시간이 필요한 상황에서 매우 효과적이다.

하지만, Redis를 사용할 때에는 메모리 용량, 네트워크 대역폭, 디스크 속도 등의 하드웨어 성능 요구 사항도 고려해야 한다.

만약, Redis 인스턴스가 메모리를 다 사용하거나, 디스크 속도가 느려지면 Redis의 성능도 떨어질 수 있다.

Redis도 충분히 빠른 속도를 보여주지만, 단일 서버에서 작동하는 Caffeine Cache는 로컬 캐시이므로 Redis보다 더 빠를 수 있다.

### 실시간으로 자주 바뀌면서 조회가 빈번하게 일어나는 데이터는 어떤 것이 적절할까?

실시간으로 자주 바뀌면서 조회가 빈번하게 일어나는 데이터는 Redis가 더 적합하다.

Redis는 인메모리 데이터 저장소이므로 데이터 접근 속도가 매우 빠르고, 실시간으로 바뀌는 데이터를 처리하는 데도 매우 효과적이다.

반면, Caffeine Cache는 로컬 캐시이므로 여러 서버에서 데이터를 공유하지 않는다.
이때문에 분산 환경에서 사용할 경우 일관성 있는 데이터를 유지하기 어렵다.

따라서, 다수의 서버에서 조회되는 데이터의 경우 Redis와 같은 분산 캐시 솔루션을 사용하는 것이 더 적합하다.

실시간으로 Redis에 데이터를 저장하고, 데이터를 가져오게 되면 네트워크 오버헤드가 발생할 수 밖에 없다.

하지만, 이러한 오버헤드는 Redis의 높은 처리 속도와 병렬 처리 능력으로 상쇄될 수 있다.

### 자주 바뀌지 않지만 조회가 빈번하게 일어나는 데이터는?

자주 바뀌지 않지만 조회가 빈번하게 일어나는 데이터는 Caffeine Cache를 사용하는 것이 좋다.

Caffeine Cache는 로컬 캐시로서 단일 서버에서만 작동하며, 자주 바뀌지 않는 데이터를 캐싱할 경우 캐시의 일관성을 유지하면서 빠른 응답 속도를 제공할 수 있다.
또한, 캐시 메모리의 제한된 크기를 잘 다루므로, 메모리 사용에 대한 효율성을 보장할 수 있다.

Redis는 메모리 사용량에 대한 고려가 필요하다.
