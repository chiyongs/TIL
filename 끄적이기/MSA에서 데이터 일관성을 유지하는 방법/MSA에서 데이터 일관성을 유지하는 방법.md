# MSA에서 데이터 일관성을 유지하는 방법

1. **이벤트 소싱(Event Sourcing)**:
   - 상태 변경을 이벤트로 저장하고, 이벤트 로그를 통해 현재 상태를 재구성합니다. 이를 통해 데이터 일관성을 유지할 수 있습니다.
   - **장점**: 데이터 변경 이력 추적이 용이하고, 다양한 상태를 재구성할 수 있습니다.
   - **단점**: 이벤트 로그 저장소가 필요하고, 시스템 복잡성이 증가할 수 있습니다.
2. **CQRS(Command Query Responsibility Segregation)**:
   - 읽기 작업과 쓰기 작업을 분리하여 각각 독립적으로 처리합니다. 쓰기 작업은 이벤트 소싱을 통해 처리하고, 읽기 작업은 별도의 읽기 전용 데이터베이스를 사용합니다.
   - **장점**: 읽기와 쓰기 성능을 각각 최적화할 수 있습니다.
   - **단점**: 시스템 복잡성이 증가하고, 데이터 일관성 유지가 어렵습니다.
3. **사후 일관성(Eventual Consistency)**:
   - 데이터 일관성을 즉시 보장하지 않고, 시간이 지나면서 일관성을 보장합니다. 마이크로서비스 간의 비동기 이벤트 기반 통신을 통해 데이터를 동기화합니다.
   - **장점**: 높은 가용성과 확장성을 제공할 수 있습니다.
   - **단점**: 즉각적인 데이터 일관성을 보장하지 않으므로, 애플리케이션 설계가 복잡해질 수 있습니다.
4. **분산 트랜잭션(Two-Phase Commit, Saga Pattern)**:
   - **Two-Phase Commit(2PC)**: 분산 트랜잭션을 관리하기 위해 준비(prepare)와 커밋(commit) 단계로 나누어 트랜잭션을 처리합니다.
     - **장점**: 트랜잭션 일관성을 보장할 수 있습니다.
     - **단점**: 성능 저하 및 복잡성 증가, 일부 케이스에서는 사용이 어려울 수 있습니다.
   - **Saga Pattern**: 분산 트랜잭션을 관리하기 위해 각 서비스가 로컬 트랜잭션을 수행하고, 실패 시 보상 작업을 통해 롤백합니다.
     - **장점**: 분산 트랜잭션을 효과적으로 관리할 수 있으며, 성능 저하가 적습니다.
     - **단점**: 보상 작업을 설계해야 하므로 복잡성이 증가합니다.
5. **API 게이트웨이와 데이터 중복**:
   - 공통 데이터를 여러 서비스에 중복 저장하여 일관성을 유지하는 방법입니다. API 게이트웨이를 통해 데이터 접근을 관리하고 동기화합니다.
   - **장점**: 각 서비스가 독립적으로 데이터를 관리할 수 있습니다.
   - **단점**: 데이터 중복으로 인한 관리 복잡성 증가.
